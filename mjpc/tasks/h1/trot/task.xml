<mujoco model="H1 Locomotion">
  <include file="../../common.xml"/>
  <include file="../h1_modified.xml" />
  <size memory="400K"/>

  <visual>
    <global offwidth="1280" offheight="720"/>
  </visual>

  <worldbody>
    <light pos="0 0 3.5" dir="0 0 -1" directional="true"/>
    <geom name="floor" type="plane" conaffinity="1" size="50 50 .05" material="blue_grid"/>
    <camera name="top" mode="targetbody" target="pelvis" pos="0 0 1.5" />
  </worldbody>

  <custom>
    <!-- agent -->
    <numeric name="agent_planner" data="2" />
    <numeric name="agent_horizon" data="0.6" />
    <numeric name="agent_timestep" data="0.02" />
    <numeric name="sampling_spline_points" data="3" />
    <numeric name="sampling_exploration" data="0.05" />
    <numeric name="gradient_spline_points" data="5" />

    <!-- residual -->
    <numeric name="residual_Cadence" data="2 0 4" />
    <numeric name="residual_Amplitude" data=".06 0 0.2" />
    <numeric name="residual_Duty ratio" data="0.5 0 1"/>
    <numeric name="residual_Walk speed" data="0 0 4"/>
    <numeric name="residual_Walk turn" data="0 -2 2"/>
    <numeric name="residual_Height goal" data="1.3 0 2"/>

    <!-- estimator --><!--
    <numeric name="estimator" data="0" />
    <numeric name="estimator_sensor_start" data="8" />
    <numeric name="estimator_number_sensor" data="26" />
    <numeric name="estimator_timestep" data="0.0075" />
    <numeric name="batch_configuration_length" data="3" />
    <numeric name="batch_scale_prior" data="1.0e-3" />-->
  </custom>

  <sensor>
    <!-- cost -->
    <user name="Upright" dim="1" user="6 1 0 3 0.05" /> <!--kSmoothAbsLoss-->
    <user name="Height" dim="1" user="6 1 0 3 0.04" /> <!--kSmoothAbsLoss-->
    <user name="Position" dim="3" user="2 0.2 0 0.5 0.1" /> <!--kL2-->
    <user name="Gait" dim="2" user="6 2 0 10 0.03" /> <!--kSmoothAbsLoss-->
    <user name="Balance" dim="2" user="2 0.2 0 0.3 0.1" /> <!--kL2-->
    <user name="Control" dim="19" user="0 0.00005 0.0 0.00005" /> <!--kQuadratic-->
    <user name="Posture up" dim="9" user="0 0.02 0.0 0.1" /> <!--kQuadratic-->

    <!-- estimator measurements -->
    <!--
    <framepos name="pelvis" objtype="site" objname="tracking[pelvis]" />
    <framepos name="right_foot" objtype="site" objname="foot_right" />
    <framepos name="left_foot" objtype="site" objname="foot_left" />
    <framepos name="right_hand" objtype="site" objname="tracking[rhand]" />
    <framepos name="left_hand" objtype="site" objname="tracking[lhand]" />
    <jointpos name="abdomen_z" joint="abdomen_z"/>
    <jointpos name="abdomen_y" joint="abdomen_y"/>
    <jointpos name="abdomen_x" joint="abdomen_x"/>
    <jointpos name="hip_x_right" joint="hip_x_right"/>
    <jointpos name="hip_z_right" joint="hip_z_right"/>
    <jointpos name="hip_y_right" joint="hip_y_right"/>
    <jointpos name="knee_right" joint="knee_right"/>
    <jointpos name="ankle_y_right" joint="ankle_y_right"/>
    <jointpos name="ankle_x_right" joint="ankle_x_right"/>
    <jointpos name="hip_x_left" joint="hip_x_left"/>
    <jointpos name="hip_z_left" joint="hip_z_left"/>
    <jointpos name="hip_y_left" joint="hip_y_left"/>
    <jointpos name="knee_left" joint="knee_left"/>
    <jointpos name="ankle_y_left" joint="ankle_y_left"/>
    <jointpos name="ankle_x_left" joint="ankle_x_left"/>
    <jointpos name="shoulder1_right" joint="shoulder1_right"/>
    <jointpos name="shoulder2_right" joint="shoulder2_right"/>
    <jointpos name="elbow_right" joint="elbow_right"/>
    <jointpos name="shoulder1_left" joint="shoulder1_left"/>
    <jointpos name="shoulder2_left" joint="shoulder2_left"/>
    <jointpos name="elbow_left" joint="elbow_left" />-->

    <!-- trace --><!--
    <framepos name="trace0" objtype="body" objname="torso"/>-->

    <!-- residual -->
    <framepos name="torso_position" objtype="body" objname="torso_link"/> <!--might be too low-->
    <subtreecom name="torso_subcom" body="pelvis"/> <!--pelvis is the root node for the H1-->
    <subtreelinvel name="torso_subcomvel" body="pelvis"/> <!--pelvis is the root node for the H1-->
    <framepos name="foot_right" objtype="body" objname="right_ankle_link"/><!--wrong-->
    <framepos name="foot_left" objtype="body" objname="left_ankle_link"/><!--wrong-->
    <framepos name="foot_right_xbody" objtype="xbody" objname="right_ankle_link"/><!--wrong-->
    <framepos name="foot_left_xbody" objtype="xbody" objname="left_ankle_link"/><!--wrong-->
    <framepos name="pelvis_position" objtype="body" objname="pelvis"/>
    <framezaxis name="torso_up" objtype="site" objname="upper_torso"/><!--upper_torso is between the shoulders-->
    <framezaxis name="pelvis_up" objtype="xbody" objname="pelvis"/>
    <framezaxis name="foot_right_up" objtype="xbody" objname="right_ankle_link"/><!--wrong-->
    <framezaxis name="foot_left_up" objtype="xbody" objname="left_ankle_link"/><!--wrong-->
    <framexaxis name="torso_forward" objtype="site" objname="upper_torso"/>
    <framexaxis name="pelvis_forward" objtype="xbody" objname="pelvis"/>
    <framexaxis name="foot_right_forward" objtype="xbody" objname="right_ankle_link"/><!--wrong-->
    <framexaxis name="foot_left_forward" objtype="xbody" objname="left_ankle_link"/><!--wrong-->
    <subtreelinvel name="waist_lower_subcomvel" body="legs"/>
    <framelinvel name="torso_velocity" objtype="body" objname="torso_link"/> <!--might be too low-->
    <framelinvel name="foot_right_velocity" objtype="body" objname="right_ankle_link"/><!--wrong-->
    <framelinvel name="foot_left_velocity" objtype="body" objname="left_ankle_link"/><!--wrong-->
    <frameangvel name="foot_right_ang_velocity" objtype="body" objname="right_ankle_link"/><!--wrong-->
    <frameangvel name="foot_left_ang_velocity" objtype="body" objname="left_ankle_link"/><!--wrong-->
  </sensor>
</mujoco>
